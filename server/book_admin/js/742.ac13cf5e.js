"use strict";(self.webpackChunkbookadmin=self.webpackChunkbookadmin||[]).push([[742],{2559:function(e,t,i){i.d(t,{Z:function(){return l}}),i(7658);var s={name:"ImgUpload",props:{value:{type:String,default:""},limit:{type:Number,default:5},maxSize:{type:Number,default:2048}},data(){return{dialogVisible:!1,dialogImageUrl:"",innerValueChange:!1,fileList:[]}},computed:{uploadHide(){return this.fileList?.length==this.limit}},watch:{value(e){this.innerValueChange?this.innerValueChange=!1:this.fileList=this.value?this.value.split(",").map((e=>({url:e}))):[]}},mounted(){this.fileList=this.value?this.value.split(",").map((e=>({url:e}))):[]},methods:{onOutOfLimit(){this.$message.warning("文件上传个数超过限制！")},handlePictureCardPreview(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},proxyURL(e){return e.startsWith("/")?this.$api.URL.proxy+e:e},handleRemove(e){this.fileList.remove((t=>t.url==e.url)),this.emitValue()},handeleBefore(e){if(e.size/1024>this.maxSize)return this.$message.error(`文件大小超过限制：${this.maxSize}Kb`),!1},handleSuccess(e,t,i){this.fileList.push(t),this.fileList=Array.from(this.fileList),this.emitValue()},handleError(e){this.$message.error("上传失败，请重试："+e)},emitValue(){this.innerValueChange=!0,this.$emit("input",this.fileList.map((e=>e.response?e.response.url:e.url)).join(","))}}},l=(0,i(1001).Z)(s,(function(){var e=this,t=e._self._c;return t("div",[t("el-upload",{ref:"upload",class:{hide:e.uploadHide},attrs:{action:e.$api.URL.upload,"list-type":"picture-card",multiple:!0,accept:"image/*",name:"file",limit:e.limit,"file-list":e.fileList,"on-exceed":e.onOutOfLimit,"on-success":e.handleSuccess,"on-error":e.handleError,"before-upload":e.handeleBefore},scopedSlots:e._u([{key:"file",fn:function({file:i}){return t("div",{staticClass:"imgbox",class:{success:i.status}},[t("img",{attrs:{src:e.proxyURL(i.url),alt:""}}),t("span",{staticClass:"el-upload-list__item-actions"},[t("span",{staticClass:"el-upload-list__item-preview",on:{click:function(t){return e.handlePictureCardPreview(i)}}},[t("i",{staticClass:"el-icon-zoom-in"})]),t("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleRemove(i)}}},[t("i",{staticClass:"el-icon-delete"})])])])}}])},[t("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"}),t("div",{staticStyle:{"font-size":"0.8em"},attrs:{slot:"tip"},slot:"tip"},[e._v("支持最多"+e._s(e.limit)+"张图片，每张图片不超过"+e._s(e.maxSize)+"Kb")])]),t("el-dialog",{attrs:{visible:e.dialogVisible,"append-to-body":"","custom-class":"imgdialog"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("img",{staticStyle:{"max-width":"100%","max-heigt":"100%","object-fit":"contain"},attrs:{src:e.proxyURL(e.dialogImageUrl),alt:""}})])],1)}),[],!1,null,"ada29738",null).exports},8742:function(e,t,i){i.r(t),i.d(t,{default:function(){return l}});var s={name:"User",components:{ImgUpload:i(2559).Z},data(){return{user:{img:"/file/f1.jpg",name:"小卤蛋"}}},methods:{save(){this.$message.warning("别点了，这个没实现！")}}},l=(0,i(1001).Z)(s,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"page"},[t("p",{staticClass:"h"},[e._v("个人信息")]),t("el-form",{attrs:{model:e.user,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"头像"}},[t("ImgUpload",{attrs:{limit:1},model:{value:e.user.img,callback:function(t){e.$set(e.user,"img",t)},expression:"user.img"}})],1),t("el-form-item",{attrs:{label:"用户名"}},[t("el-input",{attrs:{placeholder:""},model:{value:e.user.name,callback:function(t){e.$set(e.user,"name",t)},expression:"user.name"}})],1),t("el-form-item",{attrs:{label:"密码"}},[t("el-input",{attrs:{type:"password",placeholder:""},model:{value:e.user.pwd,callback:function(t){e.$set(e.user,"pwd",t)},expression:"user.pwd"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"success"},on:{click:e.save}},[e._v("保存修改")])],1)],1)],1)}),[],!1,null,"ebe96f1e",null).exports}}]);
//# sourceMappingURL=742.ac13cf5e.js.map