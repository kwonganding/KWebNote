(self.webpackChunkbookadmin=self.webpackChunkbookadmin||[]).push([[38],{1582:function(e,t,i){"use strict";i.d(t,{Z:function(){return o}});var a=i(5242),s=i(2403),l={components:{Editor:a.M,Toolbar:a.o},props:{html:{type:String},height:{default:"200px"}},computed:{content:{get(){return this.html},set(e){this.$emit("update:html",e)}}},data(){return{editor:null,toolbarConfig:{excludeKeys:["group-video","emotion","lineHeight"]},editorConfig:{placeholder:"请输入内容...",maxLength:8e3,MENU_CONF:{uploadImage:{server:this.$api.URL.upload,fieldName:"file",maxFileSize:8388608,maxNumberOfFiles:1,allowedFileTypes:["image/*"],timeout:9e3,customInsert:(e,t)=>{t(this.$api.URL.proxy+e.url)}}}},mode:"default",onOutOfMaxLength:(0,s.P2)((()=>this.$message.warning("富文本内容长度超过最大值："+this.editorConfig.maxLength)),1e3)}},methods:{onCreated(e){this.editor=Object.seal(e)},onMaxLength(){this.onOutOfMaxLength()}},updated(){},beforeDestroy(){this.editor?.destroy()}},o=(0,i(1001).Z)(l,(function(){var e=this,t=e._self._c;return t("div",{staticStyle:{border:"1px solid #DCDFE6"}},[t("Toolbar",{staticStyle:{"border-bottom":"1px solid #DCDFE6"},attrs:{editor:e.editor,defaultConfig:e.toolbarConfig,mode:e.mode}}),t("Editor",{staticStyle:{"overflow-y":"hidden"},style:{height:e.height},attrs:{defaultConfig:e.editorConfig,mode:e.mode},on:{onMaxLength:e.onMaxLength,onCreated:e.onCreated},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1)}),[],!1,null,null,null).exports},2559:function(e,t,i){"use strict";i.d(t,{Z:function(){return s}}),i(7658);var a={name:"ImgUpload",props:{value:{type:String,default:""},limit:{type:Number,default:5},maxSize:{type:Number,default:2048}},data(){return{dialogVisible:!1,dialogImageUrl:"",innerValueChange:!1,fileList:[]}},computed:{uploadHide(){return this.fileList?.length==this.limit}},watch:{value(e){this.innerValueChange?this.innerValueChange=!1:this.fileList=this.value?this.value.split(",").map((e=>({url:e}))):[]}},mounted(){this.fileList=this.value?this.value.split(",").map((e=>({url:e}))):[]},methods:{onOutOfLimit(){this.$message.warning("文件上传个数超过限制！")},handlePictureCardPreview(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},proxyURL(e){return e.startsWith("/")?this.$api.URL.proxy+e:e},handleRemove(e){this.fileList.remove((t=>t.url==e.url)),this.emitValue()},handeleBefore(e){if(e.size/1024>this.maxSize)return this.$message.error(`文件大小超过限制：${this.maxSize}Kb`),!1},handleSuccess(e,t,i){this.fileList.push(t),this.fileList=Array.from(this.fileList),this.emitValue()},handleError(e){this.$message.error("上传失败，请重试："+e)},emitValue(){this.innerValueChange=!0,this.$emit("input",this.fileList.map((e=>e.response?e.response.url:e.url)).join(","))}}},s=(0,i(1001).Z)(a,(function(){var e=this,t=e._self._c;return t("div",[t("el-upload",{ref:"upload",class:{hide:e.uploadHide},attrs:{action:e.$api.URL.upload,"list-type":"picture-card",multiple:!0,accept:"image/*",name:"file",limit:e.limit,"file-list":e.fileList,"on-exceed":e.onOutOfLimit,"on-success":e.handleSuccess,"on-error":e.handleError,"before-upload":e.handeleBefore},scopedSlots:e._u([{key:"file",fn:function({file:i}){return t("div",{staticClass:"imgbox",class:{success:i.status}},[t("img",{attrs:{src:e.proxyURL(i.url),alt:""}}),t("span",{staticClass:"el-upload-list__item-actions"},[t("span",{staticClass:"el-upload-list__item-preview",on:{click:function(t){return e.handlePictureCardPreview(i)}}},[t("i",{staticClass:"el-icon-zoom-in"})]),t("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleRemove(i)}}},[t("i",{staticClass:"el-icon-delete"})])])])}}])},[t("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"}),t("div",{staticStyle:{"font-size":"0.8em"},attrs:{slot:"tip"},slot:"tip"},[e._v("支持最多"+e._s(e.limit)+"张图片，每张图片不超过"+e._s(e.maxSize)+"Kb")])]),t("el-dialog",{attrs:{visible:e.dialogVisible,"append-to-body":"","custom-class":"imgdialog"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("img",{staticStyle:{"max-width":"100%","max-heigt":"100%","object-fit":"contain"},attrs:{src:e.proxyURL(e.dialogImageUrl),alt:""}})])],1)}),[],!1,null,"ada29738",null).exports},8241:function(e,t,i){"use strict";i.d(t,{Z:function(){return r}});var a={props:{total:{type:Number,default:0},size:{type:Number,default:10},index:{type:Number,default:1}},computed:{currentPage:{get(){return this.index},set(e){this.$emit("update:index",e)}},pageSize:{get(){return this.size},set(e){this.$emit("update:size",e)}}},methods:{pageSizeChanged(e){this.$emit("update:size",e),this.$emit("pagination")},pageChanged(e){this.$emit("update:index",e),this.$emit("pagination")}}},s=i(1001),l=i(4363),o=i.n(l),n=(0,s.Z)(a,(function(){var e=this;return(0,e._self._c)("el-pagination",{staticStyle:{"text-align":"right","margin-top":"5px"},attrs:{background:"",total:e.total,"current-page":e.currentPage,"page-size":e.pageSize,"page-sizes":[5,10,20,50],layout:"total, sizes, prev, pager, next, jumper"},on:{"current-change":e.pageChanged,"size-change":e.pageSizeChanged}})}),[],!1,null,null,null);"function"==typeof o()&&o()(n);var r=n.exports},4038:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return p}}),i(7658);var a=i(1743),s={data(){return{visible:!1,loading:!1,item:{}}},methods:{formatTime:a.m,show(e){this.visible=!0,this.loading=!0,this.$api.api({id:e.id}).then((e=>{this.item=e.data})).catch((e=>{this.$message.error(e)})).finally((()=>{this.loading=!1})),setTimeout((()=>{this.item=e}),100)}}},l=i(1001),o=(0,l.Z)(s,(function(){var e=this,t=e._self._c;return t("el-drawer",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{title:e.item?.name,visible:e.visible,size:"540px","custom-class":"detail-box"},on:{"update:visible":function(t){e.visible=t}}},[t("span",{staticClass:"ititle"},[e._v("标题：")]),t("p",{staticClass:"ivalue"},[e._v("内容")]),t("span",{staticClass:"ititle"},[e._v("状态：")]),t("el-tag",{staticClass:"ivalue",attrs:{type:"warning"}},[e._v("状态")]),t("span",{staticClass:"ititle"},[e._v("价格：")]),t("p",{staticClass:"ivalue"},[e._v("￥1333.2345")]),t("span",{staticClass:"ititle"},[e._v("创建时间：")]),t("p",{staticClass:"ivalue"},[e._v(e._s(e.formatTime(e.item?.createtime,"{y}-{m}-{d} {h}:{i}:{s}")))]),t("span",{staticClass:"ititle"},[e._v("更新时间：")]),t("p",{staticClass:"ivalue"},[e._v(e._s(e.formatTime(e.item?.lasttime,"{y}-{m}-{d} {h}:{i}:{s}")))])],1)}),[],!1,null,"99bcc004",null).exports,n=i(1582),r=i(2559),m={components:{Editor:n.Z,ImgUpload:r.Z},data:()=>({visible:!1,fullscreen:!1,loading:!1,saveLoading:!1,item:{},itemRules:{name:{required:!0,message:"必填"}},dialogType:"新增"}),methods:{formatTime:a.m,save(){this.$refs.itemForm.validate(((e,t)=>{e?(this.saveLoading=!0,this.$api.api(this.item).then((e=>{this.$message.success("保存成功"),this.$emit("updated"),this.visible=!1})).catch((e=>{this.$message.error(e)})).finally((()=>{this.saveLoading=!1}))):this.$message.error("输入有误，请修改后重新提交！")}))},show(e){this.visible=!0,e?(this.dialogType="修改",this.loading=!0,this.$api.api({id:e.id}).then((e=>{})).catch((e=>{this.$message.error(e)})).finally((()=>{this.loading=!1})),setTimeout((()=>{this.item=e}),100)):this.item={}}}},c=(0,l.Z)(m,(function(){var e=this,t=e._self._c;return t("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{visible:e.visible,"show-close":!1,fullscreen:e.fullscreen,width:"1160px",top:"10vh"},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",[t("i",{staticClass:"el-icon-edit"}),e._v(" "+e._s(e.dialogType)+" -书籍信息 ")]),t("span",{staticStyle:{float:"right","margin-top":"-5px"}},[t("el-button",{attrs:{icon:"el-icon-full-screen",type:"text",title:"全屏"},on:{click:function(t){e.fullscreen=!e.fullscreen}}}),t("el-button",{attrs:{icon:"el-icon-close",type:"text",title:"关闭"},on:{click:function(t){e.visible=!1}}})],1)]},proxy:!0}])},[t("el-form",{ref:"itemForm",attrs:{model:e.item,rules:e.itemRules,"label-width":"90px"}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"名称：",prop:"name"}},[t("el-input",{attrs:{placeholder:"输入书籍名称",maxlength:"50"},model:{value:e.item.name,callback:function(t){e.$set(e.item,"name",t)},expression:"item.name"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"作者：",prop:"author"}},[t("el-input",{attrs:{placeholder:"输入书籍作者",maxlength:"50"},model:{value:e.item.author,callback:function(t){e.$set(e.item,"author",t)},expression:"item.author"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"价格：",prop:"price"}},[t("el-input",{attrs:{placeholder:"输入价格"},model:{value:e.item.price,callback:function(t){e.$set(e.item,"price",e._n(t))},expression:"item.price"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"上架状态：",prop:"status"}},[t("el-radio-group",{model:{value:e.item.status,callback:function(t){e.$set(e.item,"status",t)},expression:"item.status"}},e._l(e.$consts.bookStatus.entries,(function(i){return t("el-radio",{key:i.key,attrs:{border:"",label:i.key}},[e._v(e._s(i.text))])})),1)],1)],1)],1),t("el-form-item",{attrs:{label:"图片："}},[t("ImgUpload",{model:{value:e.item.imgs,callback:function(t){e.$set(e.item,"imgs",t)},expression:"item.imgs"}})],1),t("el-form-item",{attrs:{label:"内容简介："}},[t("Editor",{attrs:{html:e.item.introduction},on:{"update:html":function(t){return e.$set(e.item,"introduction",t)}}})],1),t("el-row",{directives:[{name:"show",rawName:"v-show",value:e.item.id,expression:"item.id"}]},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"创建时间：",prop:"price"}},[t("span",[e._v(e._s(e.formatTime(e.item.createtime,"{y}-{m}-{d} {h}:{i}:{s}")))])])],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"更新时间：",prop:"tag"}},[t("span",[e._v(e._s(e.formatTime(e.item.lasttime,"{y}-{m}-{d} {h}:{i}:{s}")))])])],1)],1)],1),t("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{icon:"el-icon-circle-close"},on:{click:function(t){e.visible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-success",loading:e.saveLoading},on:{click:e.save}},[e._v("保存")])],1)],1)}),[],!1,null,null,null).exports,u={components:{Editor:n.Z,ImgUpload:r.Z},data:()=>({visible:!1,loading:!1,saveLoading:!1,item:{},itemRules:{name:{required:!0,message:"必填"}},dialogType:"新增"}),methods:{formatTime:a.m,save(){this.$refs.itemForm.validate(((e,t)=>{e?(this.saveLoading=!0,this.$api.api(this.item).then((e=>{this.$message.success("保存成功"),this.$emit("updated"),this.visible=!1})).catch((e=>{this.$message.error(e)})).finally((()=>{this.saveLoading=!1}))):this.$message.error("输入有误，请修改后重新提交！")}))},show(e){this.visible=!0,e?(this.dialogType="修改",this.loading=!0,this.$api.api({id:e.id}).then((e=>{})).catch((e=>{this.$message.error(e)})).finally((()=>{this.loading=!1})),setTimeout((()=>{this.item=e}),100)):this.item={}}}},d={name:"TempList",components:{ItemDetail:o,ItemDialog:c,ItemDialogPlus:(0,l.Z)(u,(function(){var e=this,t=e._self._c;return t("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"dialogPlus",attrs:{visible:e.visible,"show-close":!1,width:"100%",top:"0",modal:!1}},[t("div",{staticStyle:{display:"flex","justify-content":"space-between"},attrs:{slot:"title"},slot:"title"},[t("span",{staticStyle:{"font-weight":"bold","line-height":"32px"}},[t("i",{staticClass:"el-icon-edit"}),e._v(" "+e._s(e.dialogType)+" -书籍信息 ")]),t("span",[t("el-button",{attrs:{icon:"el-icon-circle-close"},on:{click:function(t){e.visible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-success",loading:e.saveLoading},on:{click:e.save}},[e._v("保存")])],1)]),t("el-form",{ref:"itemForm",attrs:{model:e.item,rules:e.itemRules,"label-width":"90px"}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"名称：",prop:"name"}},[t("el-input",{attrs:{placeholder:"输入书籍名称",maxlength:"50"},model:{value:e.item.name,callback:function(t){e.$set(e.item,"name",t)},expression:"item.name"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"作者：",prop:"author"}},[t("el-input",{attrs:{placeholder:"输入书籍作者",maxlength:"50"},model:{value:e.item.author,callback:function(t){e.$set(e.item,"author",t)},expression:"item.author"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"价格：",prop:"price"}},[t("el-input",{attrs:{placeholder:"输入价格"},model:{value:e.item.price,callback:function(t){e.$set(e.item,"price",e._n(t))},expression:"item.price"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"上架状态：",prop:"status"}},[t("el-radio-group",{model:{value:e.item.status,callback:function(t){e.$set(e.item,"status",t)},expression:"item.status"}},e._l(e.$consts.bookStatus.entries,(function(i){return t("el-radio",{key:i.key,attrs:{border:"",label:i.key}},[e._v(e._s(i.text))])})),1)],1)],1)],1),t("el-form-item",{attrs:{label:"图片："}},[t("ImgUpload",{model:{value:e.item.imgs,callback:function(t){e.$set(e.item,"imgs",t)},expression:"item.imgs"}})],1),t("el-form-item",{attrs:{label:"内容简介："}},[t("Editor",{attrs:{html:e.item.introduction},on:{"update:html":function(t){return e.$set(e.item,"introduction",t)}}})],1),t("el-row",{directives:[{name:"show",rawName:"v-show",value:e.item.id,expression:"item.id"}]},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"创建时间：",prop:"price"}},[t("span",[e._v(e._s(e.formatTime(e.item.createtime,"{y}-{m}-{d} {h}:{i}:{s}")))])])],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"更新时间：",prop:"tag"}},[t("span",[e._v(e._s(e.formatTime(e.item.lasttime,"{y}-{m}-{d} {h}:{i}:{s}")))])])],1)],1)],1)],1)}),[],!1,null,null,null).exports,Pagination:i(8241).Z},data(){return{listData:[],loading:!1,total:10,search:{id:"",name:"",index:1,size:10}}},created(){this.loadData()},methods:{formatTime:a.m,loadData(){this.loading=!0,this.$api.api(this.search).then((e=>{this.listData=e.data,this.total=e.total})).catch((e=>{this.$message.error(e)})).finally((()=>{this.loading=!1})),setTimeout((()=>{let e=[];for(let t=0;t<=this.search.size;t++)e.push({id:"10"+t,name:"测试数据-模板页面测试数据"+t,lasttime:1675319639624-1e7*t,createtime:1675319639624-3e7*t});this.listData=e}),100)},searchData(){this.search.index=1,this.loadData()},handleDelet(e){this.$confirm.warning("确定要删除吗？").then((()=>{this.$message.error("暂不支持删除功能！")})).catch()},handleDeletItems(){let e=this.$refs.listTable.selection;!e||e.length<1?this.$message.warning("未选中任何项！"):this.$confirm.warning(`确定要删除选中的 [ ${e.length} ] 项数据吗？删除后将不能恢复！`).then((()=>{this.$message.error("功能还没实现！")})).catch((()=>{}))}}},p=(0,l.Z)(d,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"view-page"},[t("div",{staticClass:"toolbar"},[t("div",{staticStyle:{"padding-top":"2px"}},[t("el-button",{attrs:{type:"primary",icon:"icon icon-add",title:"弹窗模式-覆盖父视图"},on:{click:function(t){return e.$refs.itemDialogPlus.show()}}},[e._v("新增")]),t("el-button",{attrs:{icon:"el-icon-plus",type:"primary",title:"普通弹窗模式"},on:{click:function(t){return e.$refs.itemDialog.show()}}},[e._v("新增2")]),t("el-button",{attrs:{icon:"el-icon-delete",title:"删除选择项",type:"warning",disabled:e.$refs.listTable?.selection.length<1},on:{click:e.handleDeletItems}},[e._v("删除")])],1),t("el-form",{ref:"searchForm",attrs:{model:e.search,inline:""}},[t("el-form-item",{attrs:{label:"编号",prop:"id"}},[t("el-input",{attrs:{placeholder:"请输入编号关键词",maxlength:"50"},model:{value:e.search.name,callback:function(t){e.$set(e.search,"name",t)},expression:"search.name"}})],1),t("el-form-item",{attrs:{label:"名称",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入名称关键词",maxlength:"50"},model:{value:e.search.name,callback:function(t){e.$set(e.search,"name",t)},expression:"search.name"}})],1),t("el-form-item",[t("el-button",{attrs:{icon:"el-icon-search",type:"primary",loading:e.loading},on:{click:e.searchData}},[e._v("查询")]),t("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:function(t){return e.$refs.searchForm.resetFields()}}},[e._v("重置")])],1)],1)],1),t("div",{staticClass:"view-scroll"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"listTable",staticClass:"table-scroll",attrs:{data:e.listData,"row-key":"id",border:"",stripe:""}},[t("el-table-column",{attrs:{type:"selection",width:"39"}}),t("el-table-column",{attrs:{label:"ID",width:"54px",prop:"id",align:"center"}}),t("el-table-column",{attrs:{label:"名称","min-width":"200",width:"auto",prop:"name","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(i){return t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.$refs.itemDetail.show(i.row)}}},[e._v(e._s(i.row.name))])}}])}),t("el-table-column",{attrs:{label:"修改日期",width:"100",align:"center",prop:"lasttime"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.formatTime(t.row.lasttime,"{y}-{m}-{d}")))]}}])}),t("el-table-column",{attrs:{label:"操作","class-name":"table-link-btton",width:"90",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.$refs.itemDialogPlus.show(i.row)}}},[e._v("修改")]),t("el-link",{attrs:{type:"warning"},on:{click:function(t){return e.handleDelet(i.row)}}},[e._v("删除")])]}}])})],1)],1),t("Pagination",{attrs:{total:e.total,size:e.search.size,index:e.search.index},on:{"update:size":function(t){return e.$set(e.search,"size",t)},"update:index":function(t){return e.$set(e.search,"index",t)},pagination:e.loadData}}),t("ItemDetail",{ref:"itemDetail"}),t("ItemDialog",{ref:"itemDialog",on:{updated:e.loadData}}),t("ItemDialogPlus",{ref:"itemDialogPlus",on:{updated:e.loadData}})],1)}),[],!1,null,"422904c2",null).exports},4363:function(){},1743:function(e,t,i){"use strict";function a(e,t){if(0===arguments.length||!e)return null;const i=t||"{y}-{m}-{d} {h}:{i}:{s}";let a;"object"==typeof e?a=e:("string"==typeof e&&(e=/^[0-9]+$/.test(e)?parseInt(e):e.replace(new RegExp(/-/gm),"/")),"number"==typeof e&&10===e.toString().length&&(e*=1e3),a=new Date(e));const s={y:a.getFullYear(),m:a.getMonth()+1,d:a.getDate(),h:a.getHours(),i:a.getMinutes(),s:a.getSeconds(),a:a.getDay()},l=i.replace(/{([ymdhisa])+}/g,((e,t)=>{const i=s[t];return"a"===t?["日","一","二","三","四","五","六"][i]:i.toString().padStart(2,"0")}));return l}i.d(t,{m:function(){return a}})}}]);
//# sourceMappingURL=38.ae6f6bb1.js.map