{"version":3,"file":"js/572.33d7ffa7.js","mappings":"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","sources":["webpack://bookadmin/./src/views/dic/Dictionary.vue","webpack://bookadmin/./src/views/dic/DicData.vue?3c30","webpack://bookadmin/src/views/dic/DicData.vue","webpack://bookadmin/./src/views/dic/Dictionary.vue?7f41","webpack://bookadmin/src/views/dic/Dictionary.vue","webpack://bookadmin/./src/views/dic/DicData.vue?3d50","webpack://bookadmin/./src/views/dic/DicData.vue","webpack://bookadmin/./src/views/dic/Dictionary.vue?2a42","webpack://bookadmin/./src/api/dicdata.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"page\"},[_c('div',{staticClass:\"dictype\"},[_c('div',{staticClass:\"bar\"},[_vm._m(0),_c('el-button',{attrs:{\"type\":\"text\",\"icon\":\"el-icon-document-add\",\"disabled\":\"\"}},[_vm._v(\"添加\")])],1),_c('ul',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"view-scroll\"},_vm._l((_vm.dictypeList),function(item){return _c('li',{key:item.id,class:{active:_vm.currentType===item},on:{\"click\":function($event){return _vm.handleClick(item)}}},[_vm._v(_vm._s(item.name))])}),0)]),_c('DicData',{ref:\"dicdataList\",staticClass:\"dicdata\"})],1)\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('p',{staticClass:\"title\"},[_c('i',{staticClass:\"el-icon-guide\"}),_vm._v(\" 字典类型 \")])\n}]\n\nexport { render, staticRenderFns }","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./DicData.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./DicData.vue?vue&type=script&lang=js&\"","//字典数据\r\n<template>\r\n  <div v-loading=\"loading\">\r\n    <!-- 操作按钮 -->\r\n    <div class=\"bar\">\r\n      <p class=\"title\">\r\n        <i class=\"el-icon-document\"></i>\r\n        字典数据（{{currentType.name}}）\r\n      </p>\r\n      <el-button type=\"primary\" icon=\"el-icon-document-add\" @click=\"addItem()\">添加</el-button>\r\n    </div>\r\n    <!-- 2、内容列表 -->\r\n    <el-table :data=\"dicdataList\" ref=\"tableList\" row-key=\"id\" default-expand-all border stripe style=\"margin-top:5px\">\r\n      <!-- <el-table-column label=\"ID\" width=\"60px\" prop=\"id\" align=\"center\"></el-table-column> -->\r\n      <el-table-column label=\"名称\" width=\"auto\" prop=\"name\" align=\"left\"></el-table-column>\r\n      <el-table-column label=\"排序\" width=\"80\" prop=\"sort\" align=\"center\"></el-table-column>\r\n\r\n      <el-table-column label=\"操作\" width=\"140\" align=\"center\" class-name=\"table-link-btton\">\r\n        <template slot-scope=\"scope\">\r\n          <el-link @click=\"addItem(scope.row)\" v-if=\"currentType?.tree\" type=\"success\">添加</el-link>\r\n          <el-link @click=\"editItem(scope.row)\" type=\"primary\">修改</el-link>\r\n          <el-link @click=\"deleteItem(scope.row)\" type=\"danger\">删除</el-link>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <!-- 编辑框 -->\r\n    <el-dialog :visible=\"visible\" :show-close=\"false\" width=\"500px\" top=\"15vh\">\r\n      <template #title>\r\n        <span>\r\n          <i class=\"el-icon-edit\"></i>\r\n          {{dialogType}} -字典数据\r\n        </span>\r\n        <span style=\"float:right;margin-top:-5px\">\r\n          <el-button icon=\"el-icon-close\" type=\"text\" @click=\"visible=false\" title=\"关闭\"></el-button>\r\n        </span>\r\n      </template>\r\n\r\n      <el-form :model=\"dicData\" ref=\"dataForm\" :rules=\"dataRules\" label-width=\"90px\">\r\n        <el-form-item label=\"名称：\" prop=\"name\">\r\n          <el-input v-model=\"dicData.name\" placeholder=\"输入名称\" maxlength=\"50\"></el-input>\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"父级节点：\" prop=\"pid\" v-if=\"currentType?.tree\">\r\n          <el-cascader\r\n            :options=\"dicdataList\"\r\n            v-model=\"dicData.pid\"\r\n            style=\"width:100%\"\r\n            :show-all-levels=\"false\"\r\n            :props=\"cascaderOption\"\r\n            placeholder=\"请选择父级\"\r\n            clearable\r\n          ></el-cascader>\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"排序号：\" prop=\"sort\">\r\n          <el-input-number v-model=\"dicData.sort\" placeholder=\"输入排序号\" maxlength=\"8\" style=\"width:100%\"></el-input-number>\r\n        </el-form-item>\r\n      </el-form>\r\n\r\n      <div slot=\"footer\" style=\"text-align:center\">\r\n        <el-button @click=\"visible=false\" icon=\"el-icon-circle-close\">取消</el-button>\r\n        <el-button @click=\"save\" type=\"primary\" icon=\"el-icon-success\" :loading=\"saveLoading\">保存</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { queryDicData, updateTreeDisabled, cascaderOption } from '@/api/dicdata.js'\r\n\r\nexport default {\r\n  name: 'DicData',\r\n  data() {\r\n    return {\r\n      currentType: {},  //当前选择的字典类型\r\n      dicdataList: [],  //字典数据集合\r\n      dicData: {}, //待编辑的字典数据\r\n      cascaderOption,\r\n      dataRules: { name: { required: true, message: '必填' }, sort: { type: 'number', message: '排序号必须为数字' } },  //规则\r\n      dialogType: '新增',\r\n      visible: false,\r\n      loading: false,\r\n      saveLoading: false,\r\n    }\r\n  },\r\n  methods: {\r\n    updateDicList(item) {\r\n      if (item)\r\n        this.currentType = item;\r\n      if (!this.currentType) return;\r\n      //更新\r\n      this.loading = true;\r\n      queryDicData(this.currentType.code, this.currentType.tree)\r\n        .then(data => {\r\n          this.dicdataList = data;\r\n        })\r\n        .catch(err => {\r\n          this.$message.error(err);\r\n        })\r\n        .finally(() => this.loading = false)\r\n    },\r\n    addItem(item) {\r\n      this.dialogType = '新增';\r\n      //获取一个默认排序号\r\n      let sort = 0;\r\n      if (item)\r\n        sort = item.children ? item.children.last().sort + 1 : 1;\r\n      else\r\n        sort = this.dicdataList ? this.dicdataList.last().sort + 1 : 1;\r\n      this.dicData = { name: null, code: this.currentType.code, pid: item ? item.id : 0, sort };\r\n      this.visible = true;\r\n    },\r\n    editItem(item) {\r\n      this.dialogType = '编辑';\r\n      if (this.currentType.tree)\r\n        updateTreeDisabled(this.dicdataList, item);\r\n      //前副本，避免影响列表\r\n      this.dicData = Object.assign(item);\r\n      this.visible = true;\r\n    },\r\n    save() {\r\n      this.$refs.dataForm.validate((valid, mes) => {\r\n        if (!valid) {\r\n          this.$message.error('输入有误，请修改后重新提交');\r\n          return;\r\n        }\r\n        this.saveLoading = true;\r\n        this.$api.dicdata_save({ id: this.dicData.id, name: this.dicData.name, pid: this.dicData.pid, sort: this.dicData.sort, code: this.dicData.code })\r\n          .then(res => {\r\n            this.$message.success(res.message);\r\n            //更新列表数据\r\n            this.updateDicList();\r\n          })\r\n          .finally(() => {\r\n            this.saveLoading = false;\r\n            this.visible = false;\r\n          })\r\n      })\r\n    },\r\n    deleteItem(item) {\r\n      if (item.children && item.children.length > 0) {\r\n        this.$message.warning(`[${item.name}]包含子节点，不可删除，请先删除子节点！`);\r\n        return;\r\n      }\r\n      this.$confirm.warning(`确定要删除[${item.name}]吗？删除将不可恢复！`).then(() => {\r\n        this.$api.dicdata_delete({ id: item.id })\r\n          .then(res => {\r\n            this.$message.success(res.message);\r\n            //更新列表数据\r\n            this.updateDicList();\r\n          });\r\n      }).catch(() => { });\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang='less' scoped>\r\n.bar {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  height: 32px;\r\n  line-height: 32px;\r\n  .title {\r\n    font-weight: bold;\r\n    color: #6e737c;\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Dictionary.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Dictionary.vue?vue&type=script&lang=js&\"","//字典管理\r\n<template>\r\n  <!-- 左右结构 -->\r\n  <div class=\"page\">\r\n    <div class=\"dictype\">\r\n      <div class=\"bar\">\r\n        <p class=\"title\">\r\n          <i class=\"el-icon-guide\"></i> 字典类型\r\n        </p>\r\n        <el-button type=\"text\" icon=\"el-icon-document-add\" disabled>添加</el-button>\r\n      </div>\r\n\r\n      <ul class=\"view-scroll\" v-loading=\"loading\">\r\n        <li v-for=\"item in dictypeList\" :class=\"{active:currentType===item}\" :key=\"item.id\" @click=\"handleClick(item)\">{{item.name}}</li>\r\n      </ul>\r\n    </div>\r\n\r\n    <DicData ref=\"dicdataList\" class=\"dicdata\"></DicData>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport DicData from './DicData.vue'\r\n\r\nexport default {\r\n  name: 'Dictionary',\r\n  components: { DicData },\r\n  data() {\r\n    return {\r\n      dictypeList: [],\r\n      currentType: {},\r\n      loading: false,\r\n    }\r\n  },\r\n  created() {\r\n    this.laodData()\r\n  },\r\n  methods: {\r\n    laodData() {\r\n      this.loading = true;\r\n      this.$api.dictype()\r\n        .then(res => {\r\n          this.dictypeList = res.data;\r\n          this.handleClick(this.dictypeList[0])\r\n        })\r\n        .catch(err => {\r\n          this.$message.error(err);\r\n        })\r\n        .finally(() => this.loading = false)\r\n    },\r\n    handleClick(item) {\r\n      this.currentType = item;\r\n      this.$refs.dicdataList.updateDicList(this.currentType);\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang='less' scoped>\r\n.page {\r\n  display: flex;\r\n  height: 100%;\r\n}\r\n.dictype {\r\n  flex: 250px 0 0;\r\n  padding-right: 5px;\r\n  border-right: 1px solid #ebeef5;\r\n  list-style-type: none;\r\n\r\n  .bar {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    height: 32px;\r\n    line-height: 32px;\r\n    margin-bottom: 5px;\r\n    .title {\r\n      font-weight: bold;\r\n      color: #6e737c;\r\n    }\r\n  }\r\n  li {\r\n    padding: 8px 5px;\r\n    cursor: pointer;\r\n    background: #f7f7f7;\r\n    margin-bottom: 5px;\r\n  }\r\n  li.active {\r\n    background: #409eff12;\r\n    color: #409eff;\r\n    &::after {\r\n      content: \"〉\";\r\n      float: right;\r\n    }\r\n  }\r\n}\r\n.dicdata {\r\n  width: 100%;\r\n  margin-left: 5px;\r\n  overflow: auto;\r\n}\r\n</style>","import { render, staticRenderFns } from \"./DicData.vue?vue&type=template&id=0a0ad7dd&scoped=true&\"\nimport script from \"./DicData.vue?vue&type=script&lang=js&\"\nexport * from \"./DicData.vue?vue&type=script&lang=js&\"\nimport style0 from \"./DicData.vue?vue&type=style&index=0&id=0a0ad7dd&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0a0ad7dd\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}]},[_c('div',{staticClass:\"bar\"},[_c('p',{staticClass:\"title\"},[_c('i',{staticClass:\"el-icon-document\"}),_vm._v(\" 字典数据（\"+_vm._s(_vm.currentType.name)+\"） \")]),_c('el-button',{attrs:{\"type\":\"primary\",\"icon\":\"el-icon-document-add\"},on:{\"click\":function($event){return _vm.addItem()}}},[_vm._v(\"添加\")])],1),_c('el-table',{ref:\"tableList\",staticStyle:{\"margin-top\":\"5px\"},attrs:{\"data\":_vm.dicdataList,\"row-key\":\"id\",\"default-expand-all\":\"\",\"border\":\"\",\"stripe\":\"\"}},[_c('el-table-column',{attrs:{\"label\":\"名称\",\"width\":\"auto\",\"prop\":\"name\",\"align\":\"left\"}}),_c('el-table-column',{attrs:{\"label\":\"排序\",\"width\":\"80\",\"prop\":\"sort\",\"align\":\"center\"}}),_c('el-table-column',{attrs:{\"label\":\"操作\",\"width\":\"140\",\"align\":\"center\",\"class-name\":\"table-link-btton\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [(_vm.currentType?.tree)?_c('el-link',{attrs:{\"type\":\"success\"},on:{\"click\":function($event){return _vm.addItem(scope.row)}}},[_vm._v(\"添加\")]):_vm._e(),_c('el-link',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.editItem(scope.row)}}},[_vm._v(\"修改\")]),_c('el-link',{attrs:{\"type\":\"danger\"},on:{\"click\":function($event){return _vm.deleteItem(scope.row)}}},[_vm._v(\"删除\")])]}}])})],1),_c('el-dialog',{attrs:{\"visible\":_vm.visible,\"show-close\":false,\"width\":\"500px\",\"top\":\"15vh\"},scopedSlots:_vm._u([{key:\"title\",fn:function(){return [_c('span',[_c('i',{staticClass:\"el-icon-edit\"}),_vm._v(\" \"+_vm._s(_vm.dialogType)+\" -字典数据 \")]),_c('span',{staticStyle:{\"float\":\"right\",\"margin-top\":\"-5px\"}},[_c('el-button',{attrs:{\"icon\":\"el-icon-close\",\"type\":\"text\",\"title\":\"关闭\"},on:{\"click\":function($event){_vm.visible=false}}})],1)]},proxy:true}])},[_c('el-form',{ref:\"dataForm\",attrs:{\"model\":_vm.dicData,\"rules\":_vm.dataRules,\"label-width\":\"90px\"}},[_c('el-form-item',{attrs:{\"label\":\"名称：\",\"prop\":\"name\"}},[_c('el-input',{attrs:{\"placeholder\":\"输入名称\",\"maxlength\":\"50\"},model:{value:(_vm.dicData.name),callback:function ($$v) {_vm.$set(_vm.dicData, \"name\", $$v)},expression:\"dicData.name\"}})],1),(_vm.currentType?.tree)?_c('el-form-item',{attrs:{\"label\":\"父级节点：\",\"prop\":\"pid\"}},[_c('el-cascader',{staticStyle:{\"width\":\"100%\"},attrs:{\"options\":_vm.dicdataList,\"show-all-levels\":false,\"props\":_vm.cascaderOption,\"placeholder\":\"请选择父级\",\"clearable\":\"\"},model:{value:(_vm.dicData.pid),callback:function ($$v) {_vm.$set(_vm.dicData, \"pid\", $$v)},expression:\"dicData.pid\"}})],1):_vm._e(),_c('el-form-item',{attrs:{\"label\":\"排序号：\",\"prop\":\"sort\"}},[_c('el-input-number',{staticStyle:{\"width\":\"100%\"},attrs:{\"placeholder\":\"输入排序号\",\"maxlength\":\"8\"},model:{value:(_vm.dicData.sort),callback:function ($$v) {_vm.$set(_vm.dicData, \"sort\", $$v)},expression:\"dicData.sort\"}})],1)],1),_c('div',{staticStyle:{\"text-align\":\"center\"},attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"icon\":\"el-icon-circle-close\"},on:{\"click\":function($event){_vm.visible=false}}},[_vm._v(\"取消\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"icon\":\"el-icon-success\",\"loading\":_vm.saveLoading},on:{\"click\":_vm.save}},[_vm._v(\"保存\")])],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./Dictionary.vue?vue&type=template&id=ae266a70&scoped=true&\"\nimport script from \"./Dictionary.vue?vue&type=script&lang=js&\"\nexport * from \"./Dictionary.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Dictionary.vue?vue&type=style&index=0&id=ae266a70&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"ae266a70\",\n  null\n  \n)\n\nexport default component.exports","//数据字典的数据\r\n\r\n// import api from './api'\r\nimport api from './mockapi.js';\r\n\r\nconst ROOT_PID = 0;\r\n\r\n//************ TYPES\r\n\r\nexport const TYPES = {\r\n  bookTag: 'bookTag',\r\n  bookType: 'bookType',\r\n}\r\n\r\n//************ cascaderOption\r\n\r\nexport const cascaderOption = { value: 'id', label: 'name', emitPath: false, checkStrictly: true, disabled: 'disabled' };\r\n\r\n//************  queryDicData\r\n\r\n// type: 字典类型编码code\r\n// istree：字典数据是否树形结构，如果是树形结构则会构造树形\r\nexport function queryDicData(type, istree = false) {\r\n  return api.dicdata({ code: type }).then(res => {\r\n    if (!res.data || res.data.length <= 0) return [];\r\n    //构造树形结构\r\n    if (!istree)\r\n      return res.data.sort(sortDicData);\r\n    let sortItems = buildDicTree(res.data, ROOT_PID);\r\n    return sortItems;\r\n  })\r\n}\r\n\r\nfunction buildDicTree(items, pid) {\r\n  let sortItems = items.filter(s => s.pid == pid);\r\n  if (!sortItems || sortItems.length <= 0) return [];\r\n  sortItems.sort(sortDicData).forEach(item => {\r\n    const res = buildDicTree(items, item.id);\r\n    if (res && res.length > 0)\r\n      item.children = res.sort(sortDicData);\r\n  });\r\n  return sortItems;\r\n}\r\nfunction sortDicData(item1, item2) {\r\n  return item1.sort - item2.sort;\r\n}\r\n\r\n//************  updateTreeDisabled\r\n\r\n// 编辑数据时，级联选项中不能选择自己及自己的子级\r\nexport function updateTreeDisabled(items, currentItem) {\r\n  //重置\r\n  setDisabled(items, false);\r\n  if (!currentItem)\r\n    return;\r\n  currentItem.disabled = true;\r\n  setDisabled(currentItem.children, true);\r\n}\r\n\r\n//要遍历所有节点，修复 disabled 属性\r\nfunction setDisabled(items, value) {\r\n  if (!items || items.length <= 0) return;\r\n  items.forEach(item => {\r\n    item.disabled = value;\r\n    setDisabled(item.children, value);\r\n  })\r\n}\r\n"],"names":["name","data","currentType","dicdataList","dicData","cascaderOption","dataRules","required","message","sort","type","dialogType","visible","loading","saveLoading","methods","updateDicList","queryDicData","then","catch","finally","addItem","code","pid","editItem","updateTreeDisabled","save","id","deleteItem","components","DicData","_vm","this","_c","_self","directives","rawName","value","expression","staticClass","_v","_s","attrs","on","$event","ref","staticStyle","scopedSlots","_u","key","fn","scope","tree","row","_e","proxy","model","callback","$$v","$set","slot","dictypeList","created","laodData","handleClick","_m","_l","item","class","active","TYPES","bookTag","bookType","label","emitPath","checkStrictly","disabled","istree","api","res","length","buildDicTree","sortDicData","items","sortItems","filter","s","forEach","children","item1","item2","currentItem","setDisabled"],"sourceRoot":""}